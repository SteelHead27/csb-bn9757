{"version":3,"sources":["firebase.js","context/AuthContext.js","components/Navbar.jsx","components/Search.jsx","context/ChatContext.js","components/Chats.jsx","components/Sidebar.jsx","components/Message.jsx","components/Messages.jsx","components/Input.jsx","img/attach.png","components/Chat.jsx","pages/Home.jsx","pages/Login.jsx","pages/Register.jsx","App.js","index.js"],"names":["auth","initializeApp","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","measurementId","getAuth","storage","getStorage","db","getFirestore","AuthContext","createContext","AuthContextProvider","children","useState","currentUser","setCurrentUser","useEffect","unsub","onAuthStateChanged","user","console","log","Provider","value","Navbar","useContext","className","src","photoURL","alt","displayName","Search","username","setUsername","setUser","err","setErr","handleSearch","q","query","collection","where","getDocs","forEach","doc","data","handleSelect","combinedId","uid","getDoc","exists","setDoc","messages","updateDoc","serverTimestamp","type","placeholder","onKeyDown","e","code","onChange","target","onClick","ChatContext","ChatContextProvider","useReducer","state","action","payload","chatId","dispatch","Chats","chats","setChats","onSnapshot","getChats","Object","entries","sort","a","b","date","map","chat","u","userInfo","lastMessage","text","Sidebar","Message","message","ref","useRef","current","scrollIntoView","behavior","senderId","img","Messages","setMessages","unSub","m","id","Input","setText","setImg","handleSend","storageRef","uuid","uploadTask","uploadBytesResumable","on","error","getDownloadURL","snapshot","then","downloadURL","arrayUnion","Timestamp","now","style","display","files","htmlFor","Chat","signOut","Home","Login","navigate","useNavigate","handleSubmit","preventDefault","email","password","signInWithEmailAndPassword","onSubmit","to","Register","loading","setLoading","file","createUserWithEmailAndPassword","res","Date","getTime","updateProfile","required","disabled","App","ProtectedRoute","path","index","element","ReactDOM","createRoot","document","getElementById","render","StrictMode"],"mappings":"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","file":"static/js/main.eabd599e.chunk.js","sourcesContent":["import { initializeApp } from \"firebase/app\";\r\nimport { getAuth } from \"firebase/auth\";\r\nimport { getStorage } from \"firebase/storage\";\r\nimport { getFirestore } from \"firebase/firestore\";\r\n\r\nconst firebaseConfig = {\r\n  apiKey: \"AIzaSyB6eiocRt84rS714g48Cbdu5kSffapLE2Q\",\r\n  authDomain: \"chatapplication-ee580.firebaseapp.com\",\r\n  projectId: \"chatapplication-ee580\",\r\n  storageBucket: \"chatapplication-ee580.appspot.com\",\r\n  messagingSenderId: \"978091730307\",\r\n  appId: \"1:978091730307:web:2c4951097b4556504f82b6\",\r\n  measurementId: \"G-1LZDPJ0YF6\"\r\n};\r\n\r\n\r\n// Initialize Firebase\r\nexport const app = initializeApp(firebaseConfig);\r\nexport const auth = getAuth();\r\nexport const storage = getStorage();\r\nexport const db = getFirestore();\r\n","import { createContext, useEffect, useState } from \"react\";\r\nimport { auth } from \"../firebase\";\r\nimport { onAuthStateChanged } from \"firebase/auth\";\r\n\r\nexport const AuthContext = createContext();\r\n\r\nexport const AuthContextProvider = ({ children }) => {\r\n  const [currentUser, setCurrentUser] = useState({});\r\n\r\n  useEffect(() => {\r\n    const unsub = onAuthStateChanged(auth, (user) => {\r\n      setCurrentUser(user);\r\n      console.log(user);\r\n    });\r\n\r\n    return () => {\r\n      unsub();\r\n    };\r\n  }, []);\r\n\r\n  return (\r\n    <AuthContext.Provider value={{ currentUser }}>\r\n      {children}\r\n    </AuthContext.Provider>\r\n  );\r\n};\r\n","import React, { useContext } from \"react\";\r\nimport { AuthContext } from \"../context/AuthContext\";\r\n\r\nconst Navbar = () => {\r\n  const { currentUser } = useContext(AuthContext);\r\n\r\n  return (\r\n    <div className=\"navbar\">\r\n      <span className=\"logo\">Chat application</span>\r\n      <div className=\"user\">\r\n        <img src={currentUser.photoURL} alt=\"\" />\r\n        <k>{currentUser.displayName}</k>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Navbar;\r\n","import React, { useContext, useState } from \"react\";\r\nimport {\r\n  collection,\r\n  query,\r\n  where,\r\n  getDocs,\r\n  setDoc,\r\n  doc,\r\n  updateDoc,\r\n  serverTimestamp,\r\n  getDoc\r\n} from \"firebase/firestore\";\r\nimport { db } from \"../firebase\";\r\nimport { AuthContext } from \"../context/AuthContext\";\r\nconst Search = () => {\r\n  const [username, setUsername] = useState(\"\");\r\n  const [user, setUser] = useState(null);\r\n  const [err, setErr] = useState(false);\r\n\r\n  const { currentUser } = useContext(AuthContext);\r\n\r\n  const handleSearch = async () => {\r\n    const q = query(\r\n      collection(db, \"users\"),\r\n      where(\"displayName\", \"==\", username)\r\n    );\r\n\r\n    try {\r\n      const querySnapshot = await getDocs(q);\r\n      querySnapshot.forEach((doc) => {\r\n        setUser(doc.data());\r\n      });\r\n    } catch (err) {\r\n      setErr(true);\r\n    }\r\n  };\r\n\r\n  const handleKey = (e) => {\r\n    e.code === \"Enter\" && handleSearch();\r\n  };\r\n\r\n  const handleSelect = async () => {\r\n    //check whether the group(chats in firestore) exists, if not create\r\n    const combinedId =\r\n      currentUser.uid > user.uid\r\n        ? currentUser.uid + user.uid\r\n        : user.uid + currentUser.uid;\r\n    try {\r\n      const res = await getDoc(doc(db, \"chats\", combinedId));\r\n\r\n      if (!res.exists()) {\r\n        //create a chat in chats collection\r\n        await setDoc(doc(db, \"chats\", combinedId), { messages: [] });\r\n\r\n        //create user chats\r\n        await updateDoc(doc(db, \"userChats\", currentUser.uid), {\r\n          [combinedId + \".userInfo\"]: {\r\n            uid: user.uid,\r\n            displayName: user.displayName,\r\n            photoURL: user.photoURL\r\n          },\r\n          [combinedId + \".date\"]: serverTimestamp()\r\n        });\r\n\r\n        await updateDoc(doc(db, \"userChats\", user.uid), {\r\n          [combinedId + \".userInfo\"]: {\r\n            uid: currentUser.uid,\r\n            displayName: currentUser.displayName,\r\n            photoURL: currentUser.photoURL\r\n          },\r\n          [combinedId + \".date\"]: serverTimestamp()\r\n        });\r\n      }\r\n    } catch (err) {}\r\n\r\n    setUser(null);\r\n    setUsername(\"\");\r\n  };\r\n  return (\r\n    <div className=\"search\">\r\n      <div className=\"searchForm\">\r\n        <input\r\n          type=\"text\"\r\n          placeholder=\"Find a user\"\r\n          onKeyDown={handleKey}\r\n          onChange={(e) => setUsername(e.target.value)}\r\n          value={username}\r\n        />\r\n      </div>\r\n      {err && <span>User not found!</span>}\r\n      {user && (\r\n        <div className=\"userChat\" onClick={handleSelect}>\r\n          <img src={user.photoURL} alt=\"\" />\r\n          <div className=\"userChatInfo\">\r\n            <span>{user.displayName}</span>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Search;\r\n","import { createContext, useContext, useReducer } from \"react\";\r\nimport { AuthContext } from \"./AuthContext\";\r\n\r\nexport const ChatContext = createContext();\r\n\r\nexport const ChatContextProvider = ({ children }) => {\r\n  const { currentUser } = useContext(AuthContext);\r\n  const INITIAL_STATE = {\r\n    chatId: \"null\",\r\n    user: {}\r\n  };\r\n\r\n  const chatReducer = (state, action) => {\r\n    switch (action.type) {\r\n      case \"CHANGE_USER\":\r\n        return {\r\n          user: action.payload,\r\n          chatId:\r\n            currentUser.uid > action.payload.uid\r\n              ? currentUser.uid + action.payload.uid\r\n              : action.payload.uid + currentUser.uid\r\n        };\r\n\r\n      default:\r\n        return state;\r\n    }\r\n  };\r\n\r\n  const [state, dispatch] = useReducer(chatReducer, INITIAL_STATE);\r\n\r\n  return (\r\n    <ChatContext.Provider value={{ data: state, dispatch }}>\r\n      {children}\r\n    </ChatContext.Provider>\r\n  );\r\n};\r\n","import { doc, onSnapshot } from \"firebase/firestore\";\r\nimport React, { useContext, useEffect, useState } from \"react\";\r\nimport { AuthContext } from \"../context/AuthContext\";\r\nimport { ChatContext } from \"../context/ChatContext\";\r\nimport { db } from \"../firebase\";\r\n\r\nconst Chats = () => {\r\n  const [chats, setChats] = useState([]);\r\n\r\n  const { currentUser } = useContext(AuthContext);\r\n  const { dispatch } = useContext(ChatContext);\r\n\r\n  useEffect(() => {\r\n    const getChats = () => {\r\n      const unsub = onSnapshot(doc(db, \"userChats\", currentUser.uid), (doc) => {\r\n        setChats(doc.data());\r\n      });\r\n\r\n      return () => {\r\n        unsub();\r\n      };\r\n    };\r\n\r\n    currentUser.uid && getChats();\r\n  }, [currentUser.uid]);\r\n\r\n  const handleSelect = (u) => {\r\n    dispatch({ type: \"CHANGE_USER\", payload: u });\r\n  };\r\n\r\n  return (\r\n    <div className=\"chats\">\r\n      {Object.entries(chats)\r\n        ?.sort((a, b) => b[1].date - a[1].date)\r\n        .map((chat) => (\r\n          <div\r\n            className=\"userChat\"\r\n            key={chat[0]}\r\n            onClick={() => handleSelect(chat[1].userInfo)}\r\n          >\r\n            <img src={chat[1].userInfo.photoURL} alt=\"\" />\r\n            <div className=\"userChatInfo\">\r\n              <span>{chat[1].userInfo.displayName}</span>\r\n              <p>{chat[1].lastMessage?.text}</p>\r\n            </div>\r\n          </div>\r\n        ))}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Chats;\r\n","import React from \"react\";\r\nimport Navbar from \"./Navbar\";\r\nimport Search from \"./Search\";\r\nimport Chats from \"./Chats\";\r\n\r\nconst Sidebar = () => {\r\n  return (\r\n    <div className=\"sidebar\">\r\n      <Navbar />\r\n      <Search />\r\n      <Chats />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Sidebar;\r\n","import React, { useContext, useEffect, useRef } from \"react\";\r\nimport { AuthContext } from \"../context/AuthContext\";\r\nimport { ChatContext } from \"../context/ChatContext\";\r\n\r\nconst Message = ({ message }) => {\r\n  const { currentUser } = useContext(AuthContext);\r\n  const { data } = useContext(ChatContext);\r\n\r\n  const ref = useRef();\r\n\r\n  useEffect(() => {\r\n    ref.current?.scrollIntoView({ behavior: \"smooth\" });\r\n  }, [message]);\r\n\r\n  return (\r\n    <div\r\n      ref={ref}\r\n      className={`message ${message.senderId === currentUser.uid && \"owner\"}`}\r\n    >\r\n      <div className=\"messageInfo\">\r\n        <img\r\n          src={\r\n            message.senderId === currentUser.uid\r\n              ? currentUser.photoURL\r\n              : data.user.photoURL\r\n          }\r\n          alt=\"\"\r\n        />\r\n        <span>just now</span>\r\n      </div>\r\n      <div className=\"messageContent\">\r\n        <p>{message.text}</p>\r\n        {message.img && <img src={message.img} alt=\"\" />}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Message;\r\n","import { doc, onSnapshot } from \"firebase/firestore\";\r\nimport React, { useContext, useEffect, useState } from \"react\";\r\nimport { ChatContext } from \"../context/ChatContext\";\r\nimport { db } from \"../firebase\";\r\nimport Message from \"./Message\";\r\n\r\nconst Messages = () => {\r\n  const [messages, setMessages] = useState([]);\r\n  const { data } = useContext(ChatContext);\r\n\r\n  useEffect(() => {\r\n    const unSub = onSnapshot(doc(db, \"chats\", data.chatId), (doc) => {\r\n      doc.exists() && setMessages(doc.data().messages);\r\n    });\r\n\r\n    return () => {\r\n      unSub();\r\n    };\r\n  }, [data.chatId]);\r\n\r\n  console.log(messages);\r\n\r\n  return (\r\n    <div className=\"messages\">\r\n      {messages.map((m) => (\r\n        <Message message={m} key={m.id} />\r\n      ))}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Messages;\r\n","import React, { useContext, useState } from \"react\";\r\nimport Img from \"../img/attach.png\";\r\nimport { AuthContext } from \"../context/AuthContext\";\r\nimport { ChatContext } from \"../context/ChatContext\";\r\nimport {\r\n  arrayUnion,\r\n  doc,\r\n  serverTimestamp,\r\n  Timestamp,\r\n  updateDoc\r\n} from \"firebase/firestore\";\r\nimport { db, storage } from \"../firebase\";\r\nimport { v4 as uuid } from \"uuid\";\r\nimport { getDownloadURL, ref, uploadBytesResumable } from \"firebase/storage\";\r\n\r\nconst Input = () => {\r\n  const [text, setText] = useState(\"\");\r\n  const [img, setImg] = useState(null);\r\n\r\n  const { currentUser } = useContext(AuthContext);\r\n  const { data } = useContext(ChatContext);\r\n\r\n  const handleSend = async () => {\r\n    if (img) {\r\n      const storageRef = ref(storage, uuid());\r\n\r\n      const uploadTask = uploadBytesResumable(storageRef, img);\r\n\r\n      uploadTask.on(\r\n        (error) => {\r\n          //TODO:Handle Error\r\n        },\r\n        () => {\r\n          getDownloadURL(uploadTask.snapshot.ref).then(async (downloadURL) => {\r\n            await updateDoc(doc(db, \"chats\", data.chatId), {\r\n              messages: arrayUnion({\r\n                id: uuid(),\r\n                text,\r\n                senderId: currentUser.uid,\r\n                date: Timestamp.now(),\r\n                img: downloadURL\r\n              })\r\n            });\r\n          });\r\n        }\r\n      );\r\n    } else {\r\n      await updateDoc(doc(db, \"chats\", data.chatId), {\r\n        messages: arrayUnion({\r\n          id: uuid(),\r\n          text,\r\n          senderId: currentUser.uid,\r\n          date: Timestamp.now()\r\n        })\r\n      });\r\n    }\r\n\r\n    await updateDoc(doc(db, \"userChats\", currentUser.uid), {\r\n      [data.chatId + \".lastMessage\"]: {\r\n        text\r\n      },\r\n      [data.chatId + \".date\"]: serverTimestamp()\r\n    });\r\n\r\n    await updateDoc(doc(db, \"userChats\", data.user.uid), {\r\n      [data.chatId + \".lastMessage\"]: {\r\n        text\r\n      },\r\n      [data.chatId + \".date\"]: serverTimestamp()\r\n    });\r\n\r\n    setText(\"\");\r\n    setImg(null);\r\n  };\r\n  return (\r\n    <div className=\"input\">\r\n      <input\r\n        type=\"text\"\r\n        placeholder=\"Type something...\"\r\n        onChange={(e) => setText(e.target.value)}\r\n        value={text}\r\n      />\r\n      <div className=\"send\">\r\n        <input\r\n          type=\"file\"\r\n          style={{ display: \"none\" }}\r\n          id=\"file\"\r\n          onChange={(e) => setImg(e.target.files[0])}\r\n        />\r\n        <label htmlFor=\"file\">\r\n          <img src={Img} alt=\"\" />\r\n        </label>\r\n        <button onClick={handleSend}>Send</button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Input;\r\n","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgEAQAAACJ4248AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABhElEQVR42mNgGAUkgI1Wfn7rp+zfv970yxcwnrJ//wYTX1+6WL7+UFvb+vX//2PF6q2ttPc5yKKzP39uSCsvXycsKbnRSkpq/c6yMpAYxBE+PrTzPSjY1///D7IcXQ4kBnHAvn20cwAovtf//79qlYQEuhxIDOyAmZ8+0c4B0LgmV57qDlife/To+leHDxMrT30HkMgfdcCoA0YdMOqAUQcMQwc0PX0K4q97Z2MDwmD5pqdP6ecAvo4O9GbZhqj2dto5YOanT+AGyUoeHnAjZCUbG9gRoJAAYb6ODpAYpPnGy0v1Bsr6OefPgw397+BASO26LicnsFqLc+eo54AHzc1gQ0s3bSKkdkPUli3gKJnX2Eg1B6zrEhODRcMGp6oqnOouV1dDQurDh81GIiJUbZZtOBQSsj7u3z+wBS82b95o5egIShMgDAp2mM9BatZdDgqiSdsQ7AiXjx9xdlD+f/hAM8vhzfCVoqLrnZqaNgifPbv+3efPYLz+zBlQnFM92EcEAADPUaJSrNsJswAAAABJRU5ErkJggg==\"","import React, { useContext } from \"react\";\r\nimport { signOut } from \"firebase/auth\";\r\nimport { auth } from \"../firebase\";\r\nimport Messages from \"./Messages\";\r\nimport Input from \"./Input\";\r\nimport { ChatContext } from \"../context/ChatContext\";\r\n\r\nconst Chat = () => {\r\n  const { data } = useContext(ChatContext);\r\n\r\n  return (\r\n    <div className=\"chat\">\r\n      <div className=\"chatInfo\">\r\n        <span>{data.user?.displayName}</span>\r\n        <div className=\"chatIcons\">\r\n          <t onClick={() => signOut(auth)}>logout</t>\r\n        </div>\r\n      </div>\r\n      <Messages />\r\n      <Input />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Chat;\r\n","import React from \"react\";\r\nimport Sidebar from \"../components/Sidebar\";\r\nimport Chat from \"../components/Chat\";\r\n\r\nconst Home = () => {\r\n  return (\r\n    <div className=\"home\">\r\n      <div className=\"container\">\r\n        <Sidebar />\r\n        <Chat />\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Home;\r\n","import React, { useState } from \"react\";\r\nimport { useNavigate, Link } from \"react-router-dom\";\r\nimport { signInWithEmailAndPassword } from \"firebase/auth\";\r\nimport { auth } from \"../firebase\";\r\n\r\nconst Login = () => {\r\n  const [err, setErr] = useState(false);\r\n  const navigate = useNavigate();\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    const email = e.target[0].value;\r\n    const password = e.target[1].value;\r\n\r\n    try {\r\n      await signInWithEmailAndPassword(auth, email, password);\r\n      navigate(\"/\");\r\n    } catch (err) {\r\n      setErr(true);\r\n    }\r\n  };\r\n  return (\r\n    <div className=\"formContainer\">\r\n      <div className=\"formWrapper\">\r\n        <span className=\"logo\">Chat application</span>\r\n        <span className=\"title\">Login</span>\r\n        <form onSubmit={handleSubmit}>\r\n          <input type=\"email\" placeholder=\"email\" />\r\n          <input type=\"password\" placeholder=\"password\" />\r\n          <button>Sign in</button>\r\n          {err && <span>Something went wrong</span>}\r\n        </form>\r\n        <p>\r\n          You don't have an account? <Link to=\"/register\">Register</Link>\r\n        </p>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Login;\r\n","import React, { useState } from \"react\";\r\nimport { createUserWithEmailAndPassword, updateProfile } from \"firebase/auth\";\r\nimport { auth, db, storage } from \"../firebase\";\r\nimport { ref, uploadBytesResumable, getDownloadURL } from \"firebase/storage\";\r\nimport { doc, setDoc } from \"firebase/firestore\";\r\nimport { useNavigate, Link } from \"react-router-dom\";\r\n\r\nconst Register = () => {\r\n  const [err, setErr] = useState(false);\r\n  const [loading, setLoading] = useState(false);\r\n  const navigate = useNavigate();\r\n\r\n  const handleSubmit = async (e) => {\r\n    setLoading(true);\r\n    e.preventDefault();\r\n    const displayName = e.target[0].value;\r\n    const email = e.target[1].value;\r\n    const password = e.target[2].value;\r\n    const file = e.target[3].files[0];\r\n\r\n    try {\r\n      //Create user\r\n      const res = await createUserWithEmailAndPassword(auth, email, password);\r\n\r\n      //Create a unique image name\r\n      const date = new Date().getTime();\r\n      const storageRef = ref(storage, `${displayName + date}`);\r\n\r\n      await uploadBytesResumable(storageRef, file).then(() => {\r\n        getDownloadURL(storageRef).then(async (downloadURL) => {\r\n          try {\r\n            //Update profile\r\n            await updateProfile(res.user, {\r\n              displayName,\r\n              photoURL: downloadURL\r\n            });\r\n            //create user on firestore\r\n            await setDoc(doc(db, \"users\", res.user.uid), {\r\n              uid: res.user.uid,\r\n              displayName,\r\n              email,\r\n              photoURL: downloadURL\r\n            });\r\n\r\n            //create empty user chats on firestore\r\n            await setDoc(doc(db, \"userChats\", res.user.uid), {});\r\n            navigate(\"/\");\r\n          } catch (err) {\r\n            console.log(err);\r\n            setErr(true);\r\n            setLoading(false);\r\n          }\r\n        });\r\n      });\r\n    } catch (err) {\r\n      setErr(true);\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"formContainer\">\r\n      <div className=\"formWrapper\">\r\n        <span className=\"logo\">Chat application</span>\r\n        <span className=\"title\">Register</span>\r\n        <form onSubmit={handleSubmit}>\r\n          <input required type=\"text\" placeholder=\"display name\" />\r\n          <input required type=\"email\" placeholder=\"email\" />\r\n          <input required type=\"password\" placeholder=\"password\" />\r\n          <input required type=\"file\" id=\"file\" />\r\n\r\n          <button disabled={loading}>Sign up</button>\r\n          {loading && \"Uploading and compressing the image please wait...\"}\r\n          {err && <span>Something went wrong</span>}\r\n        </form>\r\n        <p>\r\n          You do have an account? <Link to=\"/register\">Login</Link>\r\n        </p>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Register;\r\n","import Home from \"./pages/Home\";\nimport Login from \"./pages/Login\";\nimport Register from \"./pages/Register\";\nimport \"./style.scss\";\nimport { BrowserRouter, Routes, Route, Navigate } from \"react-router-dom\";\nimport { useContext } from \"react\";\nimport { AuthContext } from \"./context/AuthContext\";\n\nfunction App() {\n  const { currentUser } = useContext(AuthContext);\n\n  const ProtectedRoute = ({ children }) => {\n    if (!currentUser) {\n      return <Navigate to=\"/login\" />;\n    }\n\n    return children;\n  };\n\n  return (\n    <BrowserRouter>\n      <Routes>\n        <Route path=\"/\">\n          <Route\n            index\n            element={\n              <ProtectedRoute>\n                <Home />\n              </ProtectedRoute>\n            }\n          />\n          <Route path=\"login\" element={<Login />} />\n          <Route path=\"register\" element={<Register />} />\n        </Route>\n      </Routes>\n    </BrowserRouter>\n  );\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom/client\";\nimport App from \"./App\";\nimport { AuthContextProvider } from \"./context/AuthContext\";\nimport { ChatContextProvider } from \"./context/ChatContext\";\n\nconst root = ReactDOM.createRoot(document.getElementById(\"root\"));\nroot.render(\n  <AuthContextProvider>\n    <ChatContextProvider>\n      <React.StrictMode>\n        <App />\n      </React.StrictMode>\n    </ChatContextProvider>\n  </AuthContextProvider>\n);\n"],"sourceRoot":""}